<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Valentine</title>

<style>
  :root{
    --bg1:#fff6fb;
    --bg2:#ffe7f2;
    --bg3:#fff;
    --card: rgba(255,255,255,.72);
    --shadow: 0 26px 70px rgba(0,0,0,.12);
    --text:#2a1b2a;
    --muted:#6b3a52;
    --pink:#ff4d8d;
    --pink2:#ff77aa;
    --ring: rgba(255,77,141,.35);
  }

  *{ box-sizing:border-box; }

  body{
    margin:0;
    min-height:100vh;
    display:grid;
    place-items:center;
    font-family: ui-rounded, system-ui, -apple-system, "Segoe UI", "PingFang TC", "Noto Sans TC", sans-serif;
    color:var(--text);
    background:
      radial-gradient(1200px 800px at 18% 10%, var(--bg1), transparent 60%),
      radial-gradient(1200px 800px at 82% 92%, var(--bg2), transparent 60%),
      linear-gradient(135deg, var(--bg3), #ffeaf4);
    overflow:hidden;
  }

  /* å¾®å…‰ */
  .glow{
    position:fixed;
    width:620px; height:620px;
    background: radial-gradient(circle at 30% 30%, rgba(255,77,141,.26), transparent 55%),
                radial-gradient(circle at 70% 70%, rgba(255,119,170,.20), transparent 55%);
    filter: blur(10px);
    opacity:.9;
    pointer-events:none;
    animation: drift 8s ease-in-out infinite;
  }
  @keyframes drift{
    0%,100%{ transform: translate(-10px, -10px) scale(1); }
    50%{ transform: translate(12px, 14px) scale(1.03); }
  }

  /* æ¼‚æµ®æ„›å¿ƒèƒŒæ™¯ */
  .hearts{
    position:fixed; inset:0;
    pointer-events:none;
    overflow:hidden;
  }
  .heart{
    position:absolute;
    opacity:.20;
    animation: floatUp linear infinite;
    filter: blur(.15px);
    will-change: transform;
  }
  @keyframes floatUp{
    from{ transform: translateY(110vh) translateX(0) rotate(0deg); }
    to  { transform: translateY(-20vh) translateX(50px) rotate(360deg); }
  }

  .card{
    width:min(620px, 92vw);
    background: var(--card);
    border: 1px solid rgba(255,255,255,.55);
    border-radius: 28px;
    padding: 34px 24px 26px;
    box-shadow: var(--shadow);
    backdrop-filter: blur(14px);
    position:relative;
    overflow:hidden;
  }

  .card::before{
    content:"";
    position:absolute; inset:-2px;
    background: radial-gradient(600px 280px at 20% 0%, rgba(255,77,141,.18), transparent 55%),
                radial-gradient(600px 280px at 80% 100%, rgba(255,119,170,.14), transparent 55%);
    pointer-events:none;
  }

  h1{
    position:relative;
    margin:0;
    font-size: clamp(34px, 4.8vw, 52px);
    line-height:1.06;
    text-align:center;
    letter-spacing:-.6px;
    text-shadow: 0 10px 30px rgba(0,0,0,.06);
  }

  /* å…©æ¬„ï¼šå·¦ Yes å›ºå®šï¼Œå³ No åœ¨å³é‚Šå€å¡Šå…§äº‚è·‘ï¼ˆæ°¸é ä¸æœƒè“‹åˆ° Yesï¼‰ */
  .buttons{
    position:relative;
    margin-top: 22px;
    height: 80px;
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap: 18px;
    align-items:center;
  }
  .slot{
    position:relative;
    height:80px;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  /* âœ… æŒ‰éˆ•æ›´å° */
  button{
    border:none;
    padding:9px 12px;
    border-radius:999px;
    font-size:14px;
    font-weight:800;
    cursor:pointer;
    user-select:none;
    transition: transform .14s ease, filter .14s ease, box-shadow .14s ease, opacity .14s ease;
    white-space:nowrap;
  }

  #yes{
    background: linear-gradient(135deg, var(--pink), var(--pink2));
    color:#fff;
    min-width: 122px;
    box-shadow: 0 14px 24px rgba(255,77,141,.25);
    position:relative;
    z-index:2;
  }
  #yes:hover{ transform: translateY(-2px) scale(1.02); }
  #yes:active{ transform: translateY(0) scale(.985); filter:saturate(1.05); }
  #yes:focus-visible{
    outline:none;
    box-shadow: 0 14px 24px rgba(255,77,141,.25), 0 0 0 5px var(--ring);
  }

  #no{
    position:absolute;
    background: rgba(255,255,255,.92);
    color: var(--muted);
    border: 1px solid rgba(0,0,0,.08);
    box-shadow: 0 12px 22px rgba(0,0,0,.10);
    min-width: 122px;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    z-index:1;

    transition:
      left .42s cubic-bezier(.22,1,.36,1),
      top  .42s cubic-bezier(.22,1,.36,1),
      transform .12s ease;
  }
  #no:hover{ transform: translate(-50%, -50%) translateY(-1px); }

  /* No æŠ–å‹• */
  .shake{ animation: shake .22s infinite; }
  @keyframes shake{
    0%{transform:translate(-50%,-50%)}
    25%{transform:translate(calc(-50% - 2px), calc(-50% + 2px))}
    50%{transform:translate(calc(-50% + 2px), calc(-50% - 2px))}
    75%{transform:translate(calc(-50% - 2px), calc(-50% - 2px))}
    100%{transform:translate(-50%,-50%)}
  }

  /* å°–å« emoji */
  .scream{
    position:absolute;
    font-size:22px;
    animation: pop .65s ease-out forwards;
    pointer-events:none;
    filter: drop-shadow(0 8px 12px rgba(0,0,0,.12));
  }
  @keyframes pop{
    0%{opacity:1; transform:translate(-50%, 0) scale(1)}
    100%{opacity:0; transform:translate(-50%, -34px) scale(1.7)}
  }

  /* Are you sure é¡æ–‡å­—ï¼ˆæœ‰å‹•ç•«ï¼‰ */
  .taunt{
    position:absolute;
    font-size:14px;
    font-weight:800;
    color:#8a3a5c;
    animation: taunt 1.2s ease-out forwards;
    pointer-events:none;
    white-space:nowrap;
    filter: drop-shadow(0 10px 12px rgba(0,0,0,.10));
  }
  @keyframes taunt{
    0%{opacity:0; transform:translate(-50%, 10px) scale(.92)}
    18%{opacity:1}
    100%{opacity:0; transform:translate(-50%, -28px) scale(1.06)}
  }

  /* å½©å¸¶ç²’å­ */
  .confetti{
    position:absolute;
    width:10px; height:14px;
    border-radius:3px;
    opacity:.95;
    pointer-events:none;
    animation: confetti 900ms ease-out forwards;
    filter: drop-shadow(0 10px 10px rgba(0,0,0,.10));
  }
  @keyframes confetti{
    0%{ transform: translate(var(--x0), var(--y0)) rotate(0deg); opacity:1; }
    100%{ transform: translate(var(--x1), var(--y1)) rotate(480deg); opacity:0; }
  }

  .result{
    position:relative;
    margin-top: 18px;
    padding: 14px 14px;
    border-radius: 16px;
    background: rgba(255,255,255,.55);
    border: 1px solid rgba(255,255,255,.55);
    box-shadow: 0 12px 30px rgba(0,0,0,.06);
    min-height: 56px;
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    font-size: 18px;
    font-weight: 800;
    color:#b0124f;
  }

  .result.muted{
    color: rgba(176,18,79,.0);
    background: rgba(255,255,255,.25);
    border-color: rgba(255,255,255,.35);
  }

  .small{
    display:block;
    margin-top:6px;
    font-size: 13px;
    font-weight: 800;
    opacity:.72;
    color: #6b3a52;
  }

  /* âœ… é‡‘é¡é€ä½è·³å‹•ï¼ˆè½‰è¼ªï¼‰ */
  .money{
    display:inline-flex;
    gap:2px;
    align-items:flex-end;
    font-variant-numeric: tabular-nums;
  }
  .digit{
    position:relative;
    width: .82em;
    height: 1.2em;
    overflow:hidden;
    display:inline-block;
    border-radius:8px;
    background: rgba(255,255,255,.35);
    box-shadow: inset 0 1px 0 rgba(255,255,255,.6);
  }
  .digit-strip{
    position:absolute;
    left:0; top:0;
    width:100%;
    will-change: transform;
  }
  .digit-strip span{
    display:block;
    height: 1.2em;
    line-height: 1.2em;
    text-align:center;
  }
</style>
</head>

<body>
  <div class="glow" aria-hidden="true"></div>
  <div class="hearts" id="hearts" aria-hidden="true"></div>

  <main class="card">
    <h1>Would you be my<br>valentine â¤ï¸</h1>

    <div class="buttons" id="arena">
      <div class="slot" id="yesSlot">
        <button id="yes">Yes!!! ğŸ’–</button>
      </div>
      <div class="slot" id="noSlot">
        <button id="no" type="button">No ğŸ™ˆ</button>
      </div>
    </div>

    <div class="result muted" id="result">
      <span id="resultText">.</span>
    </div>
  </main>

<script>
  // èƒŒæ™¯æ„›å¿ƒ
  const hearts = document.getElementById('hearts');
  const heartChars = ['â¤ï¸','ğŸ’—','ğŸ’–','ğŸ’˜','ğŸ’•','ğŸ’'];
  for (let i = 0; i < 28; i++) {
    const s = document.createElement('div');
    s.className = 'heart';
    s.textContent = heartChars[Math.floor(Math.random() * heartChars.length)];
    s.style.left = (Math.random() * 100) + 'vw';
    s.style.fontSize = (12 + Math.random() * 18) + 'px';
    s.style.animationDuration = (7 + Math.random() * 10) + 's';
    s.style.animationDelay = (-Math.random() * 10) + 's';
    hearts.appendChild(s);
  }

  const arena  = document.getElementById('arena');
  const noSlot = document.getElementById('noSlot');
  const noBtn  = document.getElementById('no');
  const yesBtn = document.getElementById('yes');
  const result = document.getElementById('result');
  const resultText = document.getElementById('resultText');

  const screams = ['ğŸ˜±','ğŸ™€','ğŸ˜µ','ğŸ«£','ğŸ˜³'];
  const taunts = [
    'Are you sure?',
    'çœŸçš„è¦é€™æ¨£å—ï¼Ÿ',
    'å†æƒ³ä¸€ä¸‹å•¦â€¦',
    'ä¸å¾Œæ‚”å—ï¼Ÿ',
    'æœ€å¾Œä¸€æ¬¡æ©Ÿæœƒå–”',
    'ä½ ç¢ºå®šï¼Ÿï¼Ÿ',
    'çœŸçš„ä¸è¦å— ğŸ˜¢',
    'æˆ‘æœƒå¾ˆå‚·å¿ƒè€¶',
    'æŒ‰éŒ¯äº†å§ï¼Ÿ',
    'ä½ å¿å¿ƒå—â€¦',
    'å†çµ¦æˆ‘ä¸€æ¬¡æ©Ÿæœƒ ğŸ¥º',
    'ç¢ºå®šè¦æ‹’çµ•æˆ‘å—ï¼Ÿ'
  ];

  const MONEY_KEY = 'valentine_red_packet_money_v1';

  let lastMoveAt = 0;
  const MOVE_CD_MS = 180;

  let lastTauntAt = 0;
  const TAUNT_CD_MS = 650;

  let lastScreamAt = 0;
  const SCREAM_CD_MS = 450;

  const ACTIVE_LIMIT = 2;
  let activeTaunts = 0;

  function randInt(min, max){
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }
  function rand(arr){
    return arr[Math.floor(Math.random() * arr.length)];
  }

  // âœ… ç”¢ç”Ÿ 888ï½4888 ä¸”å°¾æ•¸å›ºå®š xx88
  function generateMoneyXX88(){
    // 88, 188, 288, ... 4888 çš„å€™é¸ï¼›å†æŠŠ <888 æ‹‰åˆ° 888
    const base = randInt(0, 48) * 100;
    let money = base + 88;
    if (money < 888) money = 888;
    if (money > 4888) money = 4888;
    return money;
  }

  function spawnScreamAndTaunt(){
    const now = performance.now();
    const b = noBtn.getBoundingClientRect();

    // åç§»é¿å…ç–Šåœ¨åŒä¸€é»
    const ox = (Math.random() * 48) - 24;
    const oy = (Math.random() * 20) - 10;

    // å°–å«ï¼ˆCDï¼‰
    if (now - lastScreamAt >= SCREAM_CD_MS) {
      lastScreamAt = now;
      const s = document.createElement('div');
      s.className = 'scream';
      s.textContent = rand(screams);
      s.style.left = (b.left + b.width/2 + ox) + 'px';
      s.style.top  = (b.top + oy) + 'px';
      document.body.appendChild(s);
      setTimeout(()=>s.remove(), 700);
    }

    // æ–‡æ¡ˆï¼ˆCD + åŒæ™‚æ•¸é‡é™åˆ¶ï¼‰
    if (now - lastTauntAt < TAUNT_CD_MS) return;
    if (activeTaunts >= ACTIVE_LIMIT) return;

    lastTauntAt = now;
    activeTaunts++;

    const t = document.createElement('div');
    t.className = 'taunt';
    t.textContent = rand(taunts);
    t.style.left = (b.left + b.width/2 + ox) + 'px';
    t.style.top  = (b.top + 26 + oy) + 'px';
    document.body.appendChild(t);

    setTimeout(()=>{
      t.remove();
      activeTaunts = Math.max(0, activeTaunts - 1);
    }, 1200);
  }

  function moveNo(){
    const now = performance.now();
    if (now - lastMoveAt < MOVE_CD_MS) return;
    lastMoveAt = now;

    const slot = noSlot.getBoundingClientRect();
    const btn  = noBtn.getBoundingClientRect();

    const pad = 6;
    const maxX = Math.max(pad, slot.width  - btn.width  - pad);
    const maxY = Math.max(pad, slot.height - btn.height - pad);

    const x = randInt(pad, maxX);
    const y = randInt(pad, maxY);

    noBtn.style.left = x + 'px';
    noBtn.style.top  = y + 'px';
    noBtn.style.transform = 'translate(0,0)';

    spawnScreamAndTaunt();
  }

  arena.addEventListener('mousemove', (e) => {
    const b = noBtn.getBoundingClientRect();
    const d = Math.hypot(
      e.clientX - (b.left + b.width/2),
      e.clientY - (b.top  + b.height/2)
    );

    if (d < 130) noBtn.classList.add('shake');
    else noBtn.classList.remove('shake');

    if (d < 90) moveNo();
  });

  noBtn.addEventListener('touchstart', (e) => { e.preventDefault(); moveNo(); }, { passive:false });
  noBtn.addEventListener('click', (e) => { e.preventDefault(); moveNo(); });

  function burstConfetti() {
    const b = yesBtn.getBoundingClientRect();
    const cx = b.left + b.width/2;
    const cy = b.top + b.height/2;

    const colors = ['#ff4d8d','#ff77aa','#ffd1e1','#fff1f7','#ffc2d6','#ffe0ec'];
    const count = 18;

    for (let i = 0; i < count; i++){
      const p = document.createElement('div');
      p.className = 'confetti';
      p.style.background = colors[randInt(0, colors.length-1)];

      const ang = Math.random() * Math.PI * 2;
      const dist = 60 + Math.random() * 120;
      const dx = Math.cos(ang) * dist;
      const dy = Math.sin(ang) * dist - (30 + Math.random()*50);

      p.style.setProperty('--x0', `0px`);
      p.style.setProperty('--y0', `0px`);
      p.style.setProperty('--x1', `${dx}px`);
      p.style.setProperty('--y1', `${dy}px`);

      p.style.left = cx + 'px';
      p.style.top  = cy + 'px';

      document.body.appendChild(p);
      setTimeout(()=>p.remove(), 950);
    }
  }

  // âœ… é€ä½è·³å‹•ï¼šæŠŠ moneyBox è®Šæˆå¤šå€‹ digit è½‰è¼ª
  function rollMoney(money){
    const moneyBox = document.getElementById('moneyBox');
    if (!moneyBox) return;

    const digits = String(money).split('');
    moneyBox.innerHTML = '';

    const digitHeightEm = 1.2; // å°æ‡‰ CSS .digit é«˜åº¦

    digits.forEach((d, i) => {
      const digit = document.createElement('span');
      digit.className = 'digit';

      const strip = document.createElement('span');
      strip.className = 'digit-strip';

      // åšå…©è¼ª 0-9ï¼Œè®“å®ƒçœ‹èµ·ä¾†æœ‰ã€Œè½‰ã€çš„è·é›¢
      const rounds = 50;
      for (let r = 0; r < rounds; r++){
        for (let n = 0; n <= 9; n++){
          const s = document.createElement('span');
          s.textContent = n;
          strip.appendChild(s);
        }
      }

      // èµ·å§‹ä½ç½®ï¼šéš¨æ©Ÿï¼ˆæ›´åƒæŠ½çï¼‰
      const start = randInt(0, 9);
      strip.style.transform = `translateY(${-start * digitHeightEm}em)`;

      // æ¯ä½ä¸åŒçš„ duration / delay
      const duration = 700 + i * 120 + randInt(0, 200);
      const delay = i * 80;

      strip.style.transition = `transform ${duration}ms cubic-bezier(.18,1,.22,1) ${delay}ms`;

      digit.appendChild(strip);
      moneyBox.appendChild(digit);

      // ä¸‹ä¸€å€‹ tick æ‰è¨­å®šç›®æ¨™ï¼Œtransition æ‰æœƒç”Ÿæ•ˆ
      requestAnimationFrame(() => {
        // ç›®æ¨™åœåœ¨æœ€å¾Œä¸€è¼ªçš„è©²æ•¸å­—ï¼ˆè®“å®ƒç¢ºå¯¦ã€Œè½‰éå»ã€ï¼‰
        const targetDigit = parseInt(d, 10);
        const targetIndex = 10 * (rounds - 1) + targetDigit;
        strip.style.transform = `translateY(${-targetIndex * digitHeightEm}em)`;
      });
    });
  }

  function renderPrize(money, animate){
    result.classList.remove('muted');
    resultText.innerHTML = `
      æ­å–œç²å¾— <b>Jelly Cat Bartholomew Bear Junior</b><br>
      and <b><span id="moneyBox" class="money"></span></b> å…ƒç´…åŒ…ï¼
      <span class="small">ï¼Šæ†‘æˆªåœ–é ˜å–</span>
    `;

    if (animate) rollMoney(money);
    else {
      // ä¸å‹•ç•«ï¼ˆä¾‹å¦‚åˆ·æ–°å¾Œç›´æ¥é¡¯ç¤ºï¼‰
      const moneyBox = document.getElementById('moneyBox');
      moneyBox.textContent = String(money);
      moneyBox.style.background = 'transparent';
    }
  }

  yesBtn.addEventListener('click', () => {
    let money = localStorage.getItem(MONEY_KEY);

    // é‡‘é¡ï¼š888ï½4888ï¼Œä¸”å°¾æ•¸å›ºå®š xx88ï¼ˆåˆ·æ–°ä¸è®Šï¼‰
    if (!money) {
      money = generateMoneyXX88();
      localStorage.setItem(MONEY_KEY, String(money));
    } else {
      money = parseInt(money, 10);
    }

    renderPrize(money, true);
    burstConfetti();

    yesBtn.animate(
      [
        { transform: 'translateY(0) scale(1)' },
        { transform: 'translateY(-2px) scale(1.05)' },
        { transform: 'translateY(0) scale(1)' }
      ],
      { duration: 360, easing: 'cubic-bezier(.22,1,.36,1)' }
    );
  });

  // åˆå§‹ï¼šNo æ”¾åˆ°å³å´å€å¡Šå…§éš¨æ©Ÿä½ç½®
  moveNo();

  // åˆ·æ–°ï¼šè‹¥å·²æŠ½éï¼Œç›´æ¥é¡¯ç¤ºåŒä¸€ç­†ï¼ˆä¸è·‘å‹•ç•«ï¼Œé¿å…ä¸€é€²ä¾†å°±äº‚è·³ï¼‰
  const savedMoney = localStorage.getItem(MONEY_KEY);
  if (savedMoney) renderPrize(parseInt(savedMoney, 10), false);

  window.addEventListener('resize', moveNo);
</script>
</body>
</html>
