<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Valentine</title>

<style>
  :root{
    --bg1:#fff6fb;
    --bg2:#ffe7f2;
    --bg3:#fff;
    --card: rgba(255,255,255,.72);
    --shadow: 0 26px 70px rgba(0,0,0,.12);
    --text:#2a1b2a;
    --muted:#6b3a52;
    --pink:#ff4d8d;
    --pink2:#ff77aa;
    --ring: rgba(255,77,141,.35);
  }

  *{ box-sizing:border-box; }

  body{
    margin:0;
    min-height:100vh;
    display:grid;
    place-items:center;
    font-family: ui-rounded, system-ui, -apple-system, "Segoe UI", "PingFang TC", "Noto Sans TC", sans-serif;
    color:var(--text);
    background:
      radial-gradient(1200px 800px at 18% 10%, var(--bg1), transparent 60%),
      radial-gradient(1200px 800px at 82% 92%, var(--bg2), transparent 60%),
      linear-gradient(135deg, var(--bg3), #ffeaf4);
    overflow:hidden;
  }

  /* æ¼‚æµ®æ„›å¿ƒèƒŒæ™¯ */
  .hearts{
    position:fixed; inset:0;
    pointer-events:none;
    overflow:hidden;
  }
  .heart{
    position:absolute;
    opacity:.22;
    animation: floatUp linear infinite;
    filter: blur(.15px);
    will-change: transform;
  }
  @keyframes floatUp{
    from{ transform: translateY(110vh) translateX(0) rotate(0deg); }
    to  { transform: translateY(-20vh) translateX(50px) rotate(360deg); }
  }

  /* å¾®å…‰ */
  .glow{
    position:fixed;
    width:620px; height:620px;
    background: radial-gradient(circle at 30% 30%, rgba(255,77,141,.26), transparent 55%),
                radial-gradient(circle at 70% 70%, rgba(255,119,170,.20), transparent 55%);
    filter: blur(10px);
    opacity:.9;
    pointer-events:none;
    animation: drift 8s ease-in-out infinite;
  }
  @keyframes drift{
    0%,100%{ transform: translate(-10px, -10px) scale(1); }
    50%{ transform: translate(12px, 14px) scale(1.03); }
  }

  .card{
    width:min(620px, 92vw);
    background: var(--card);
    border: 1px solid rgba(255,255,255,.55);
    border-radius: 28px;
    padding: 34px 24px 26px;
    box-shadow: var(--shadow);
    backdrop-filter: blur(14px);
    position:relative;
    overflow:hidden;
  }

  .card::before{
    content:"";
    position:absolute; inset:-2px;
    background: radial-gradient(600px 280px at 20% 0%, rgba(255,77,141,.18), transparent 55%),
                radial-gradient(600px 280px at 80% 100%, rgba(255,119,170,.14), transparent 55%);
    pointer-events:none;
  }

  .header{
    position:relative;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:10px;
  }

  h1{
    margin:0;
    font-size: clamp(34px, 4.8vw, 52px);
    line-height:1.06;
    letter-spacing:-.6px;
    text-shadow: 0 10px 30px rgba(0,0,0,.06);
  }

  .buttons{
    position:relative;
    margin-top: 22px;
    height: 104px;
    display:flex;
    justify-content:center;
    align-items:center;
    gap:16px;
  }

  button{
    border:none;
    padding:16px 26px;
    border-radius:999px;
    font-size:18px;
    font-weight:800;
    cursor:pointer;
    user-select:none;
    transition: transform .14s ease, filter .14s ease, box-shadow .14s ease, opacity .14s ease;
  }

  #yes{
    background: linear-gradient(135deg, var(--pink), var(--pink2));
    color:#fff;
    min-width: 170px;
    box-shadow: 0 18px 34px rgba(255,77,141,.28);
    position:relative;
    z-index:2;
  }
  #yes:hover{ transform: translateY(-2px) scale(1.02); }
  #yes:active{ transform: translateY(0) scale(.985); filter:saturate(1.05); }
  #yes:focus-visible{
    outline:none;
    box-shadow: 0 18px 34px rgba(255,77,141,.28), 0 0 0 5px var(--ring);
  }

  #no{
    position:absolute;
    background: rgba(255,255,255,.92);
    color: var(--muted);
    border: 1px solid rgba(0,0,0,.08);
    box-shadow: 0 14px 26px rgba(0,0,0,.10);
    min-width: 170px;
    left: 62%;
    top: 10px;
    z-index:1;

    /* smooth é€ƒè·‘ */
    transition:
      left .42s cubic-bezier(.22,1,.36,1),
      top  .42s cubic-bezier(.22,1,.36,1),
      transform .12s ease;
  }
  #no:hover{ transform: translateY(-1px); }

  /* No æŠ–å‹• */
  .shake{ animation: shake .22s infinite; }
  @keyframes shake{
    0%{transform:translate(0)}
    25%{transform:translate(-2px,2px)}
    50%{transform:translate(2px,-2px)}
    75%{transform:translate(-2px,-2px)}
    100%{transform:translate(0)}
  }

  /* å°–å« emoji */
  .scream{
    position:absolute;
    font-size:22px;
    animation: pop .65s ease-out forwards;
    pointer-events:none;
    filter: drop-shadow(0 8px 12px rgba(0,0,0,.12));
  }
  @keyframes pop{
    0%{opacity:1; transform:translate(-50%, 0) scale(1)}
    100%{opacity:0; transform:translate(-50%, -34px) scale(1.7)}
  }

  /* Yes çš„å½©å¸¶ç²’å­ */
  .confetti{
    position:absolute;
    width:10px; height:14px;
    border-radius:3px;
    opacity:.95;
    pointer-events:none;
    animation: confetti 900ms ease-out forwards;
    filter: drop-shadow(0 10px 10px rgba(0,0,0,.10));
  }
  @keyframes confetti{
    0%{ transform: translate(var(--x0), var(--y0)) rotate(0deg); opacity:1; }
    100%{ transform: translate(var(--x1), var(--y1)) rotate(480deg); opacity:0; }
  }

  .result{
    position:relative;
    margin-top: 18px;
    padding: 14px 14px;
    border-radius: 16px;
    background: rgba(255,255,255,.55);
    border: 1px solid rgba(255,255,255,.55);
    box-shadow: 0 12px 30px rgba(0,0,0,.06);
    min-height: 56px;
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    font-size: 18px;
    font-weight: 800;
    color:#b0124f;
  }

  .result.muted{
    color: rgba(176,18,79,.0);
    background: rgba(255,255,255,.25);
    border-color: rgba(255,255,255,.35);
  }

  .small{
    display:block;
    margin-top:6px;
    font-size: 13px;
    font-weight: 700;
    opacity:.72;
    color: #6b3a52;
  }
</style>
</head>

<body>
  <div class="glow" aria-hidden="true"></div>
  <div class="hearts" id="hearts" aria-hidden="true"></div>

  <main class="card">
    <div class="header">
      <h1>Would you be my<br>valentine â¤ï¸</h1>
    </div>

    <div class="buttons" id="arena">
      <button id="yes">Yes!!! ğŸ’–</button>
      <button id="no" type="button">No ğŸ™ˆ</button>
    </div>

    <div class="result muted" id="result">
      <span id="resultText">.</span>
    </div>
  </main>

<script>
  // æµ®å‹•æ„›å¿ƒ
  const hearts = document.getElementById('hearts');
  const heartChars = ['â¤ï¸','ğŸ’—','ğŸ’–','ğŸ’˜','ğŸ’•','ğŸ’'];
  for (let i = 0; i < 28; i++) {
    const s = document.createElement('div');
    s.className = 'heart';
    s.textContent = heartChars[Math.floor(Math.random() * heartChars.length)];
    s.style.left = (Math.random() * 100) + 'vw';
    s.style.fontSize = (12 + Math.random() * 18) + 'px';
    s.style.animationDuration = (7 + Math.random() * 10) + 's';
    s.style.animationDelay = (-Math.random() * 10) + 's';
    hearts.appendChild(s);
  }

  const arena  = document.getElementById('arena');
  const noBtn  = document.getElementById('no');
  const yesBtn = document.getElementById('yes');
  const result = document.getElementById('result');
  const resultText = document.getElementById('resultText');

  const screams = ['ğŸ˜±','ğŸ™€','ğŸ˜µ','ğŸ«£','ğŸ˜³'];
  let lastMove = 0;

  const MONEY_KEY = 'valentine_red_packet_money_v1';

  function randInt(min, max){
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function spawnScream(){
    const s = document.createElement('div');
    s.className = 'scream';
    s.textContent = screams[Math.floor(Math.random() * screams.length)];

    // æ”¾åœ¨ No æŒ‰éˆ•ä¸Šæ–¹
    const b = noBtn.getBoundingClientRect();
    s.style.left = (b.left + b.width/2) + 'px';
    s.style.top  = (b.top + 2) + 'px';

    document.body.appendChild(s);
    setTimeout(()=>s.remove(), 700);
  }

  function moveNo(){
    const now = performance.now();
    // é¿å…ç§»å‹•å¤ªé »ç¹é€ æˆæŠ–å‹•ï¼ˆæ›´ smoothï¼‰
    if (now - lastMove < 120) return;
    lastMove = now;

    const a = arena.getBoundingClientRect();
    const b = noBtn.getBoundingClientRect();

    const pad = 6;
    const maxX = Math.max(pad, a.width - b.width - pad);
    const maxY = Math.max(pad, a.height - b.height - pad);

    const x = randInt(pad, maxX);
    const y = randInt(pad, maxY);

    noBtn.style.left = x + 'px';
    noBtn.style.top  = y + 'px';

    spawnScream();
  }

  // æ›´è‡ªç„¶ï¼šé è¿‘å°±æŠ–ï¼Œè¶…è¿‘å°±è·‘
  arena.addEventListener('mousemove', (e) => {
    const b = noBtn.getBoundingClientRect();
    const d = Math.hypot(
      e.clientX - (b.left + b.width/2),
      e.clientY - (b.top  + b.height/2)
    );

    if (d < 140) noBtn.classList.add('shake');
    else noBtn.classList.remove('shake');

    if (d < 95) moveNo();
  });

  // è§¸æ§ï¼šæ‘¸åˆ°å°±è·‘ï¼ˆé˜²é»ï¼‰
  noBtn.addEventListener('touchstart', (e) => { e.preventDefault(); moveNo(); }, { passive:false });

  // é˜²æ­¢çœŸçš„é»åˆ°
  noBtn.addEventListener('click', (e) => { e.preventDefault(); moveNo(); });

  // å½©å¸¶
  function burstConfetti() {
    const b = yesBtn.getBoundingClientRect();
    const cx = b.left + b.width/2;
    const cy = b.top + b.height/2;

    const colors = ['#ff4d8d','#ff77aa','#ffd1e1','#fff1f7','#ffc2d6','#ffe0ec'];
    const count = 18;

    for (let i = 0; i < count; i++){
      const p = document.createElement('div');
      p.className = 'confetti';
      p.style.background = colors[randInt(0, colors.length-1)];

      const ang = Math.random() * Math.PI * 2;
      const dist = 60 + Math.random() * 120;
      const dx = Math.cos(ang) * dist;
      const dy = Math.sin(ang) * dist - (30 + Math.random()*50);

      p.style.setProperty('--x0', `0px`);
      p.style.setProperty('--y0', `0px`);
      p.style.setProperty('--x1', `${dx}px`);
      p.style.setProperty('--y1', `${dy}px`);

      p.style.left = cx + 'px';
      p.style.top  = cy + 'px';

      document.body.appendChild(p);
      setTimeout(()=>p.remove(), 950);
    }
  }

  function renderPrize(money){
    result.classList.remove('muted');
    resultText.innerHTML = `
      æ­å–œç²å¾— <b>Jelly Cat Bartholomew Bear Junior</b><br>
      and <b>${money}</b> å…ƒç´…åŒ…ï¼
      <span class="small">ï¼Šæ†‘æˆªåœ–é ˜å–</span>
    `;
  }

  yesBtn.addEventListener('click', () => {
    let money = localStorage.getItem(MONEY_KEY);

    // è‹¥é‚„æ²’æŠ½éï¼Œæ‰æŠ½æ–°çš„ï¼ˆç¯„åœ 888ï½3888ï¼‰
    if (!money) {
      money = randInt(888, 3888);
      localStorage.setItem(MONEY_KEY, String(money));
    }

    renderPrize(money);
    burstConfetti();

    yesBtn.animate(
      [
        { transform: 'translateY(0) scale(1)' },
        { transform: 'translateY(-2px) scale(1.05)' },
        { transform: 'translateY(0) scale(1)' }
      ],
      { duration: 360, easing: 'cubic-bezier(.22,1,.36,1)' }
    );
  });

  // åˆå§‹ï¼šNo æ”¾åˆ°éš¨æ©Ÿä½ç½®
  moveNo();

  // è‹¥ä¹‹å‰å·²æŠ½éï¼Œåˆ·æ–°å¾Œç›´æ¥é¡¯ç¤ºåŒä¸€ç­†é‡‘é¡
  const savedMoney = localStorage.getItem(MONEY_KEY);
  if (savedMoney) renderPrize(savedMoney);

  window.addEventListener('resize', moveNo);
</script>
</body>
</html>
